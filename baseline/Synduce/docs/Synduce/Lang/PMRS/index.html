<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>PMRS (Synduce.Lang.PMRS)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">Synduce</a> &#x00BB; <a href="../index.html">Lang</a> &#x00BB; PMRS</nav><header class="odoc-preamble"><h1>Module <code><span>Lang.PMRS</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-rewrite_rule" class="anchored"><a href="#type-rewrite_rule" class="anchor"></a><code><span><span class="keyword">type</span> rewrite_rule</span><span> =
  <a href="../Term/index.html#type-variable">Term.variable</a>
  * <span><a href="../Term/index.html#type-variable">Term.variable</a> <span class="xref-unresolved">Base</span>.list</span>
  * <span><a href="../Term/index.html#type-pattern">Term.pattern</a> <span class="xref-unresolved">Base</span>.option</span>
  * <a href="../Term/index.html#type-term">Term.term</a></span></code></div><div class="spec-doc"><p>A PMRS rewrite rule <code>(v, args, pattern, rhs)</code> is the rewrite rule v(args,pattern) -&gt; rhs. <code>v</code> which is a non-terminal (a recursive function in the OCaml code), <code>args</code> is a possibly empty list of arguments, <code>pattern</code> is an optional pattern, <code>rhs</code> is the production of the rule.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-top_function" class="anchored"><a href="#type-top_function" class="anchor"></a><code><span><span class="keyword">type</span> top_function</span><span> = <a href="../Term/index.html#type-variable">Term.variable</a> * <span><a href="../Term/index.html#type-variable">Term.variable</a> <span class="xref-unresolved">Base</span>.list</span> * <a href="../Term/index.html#type-term">Term.term</a></span></code></div><div class="spec-doc"><p>A toplevel function is a triple of a variable (the variable representing the function itself), a list of variables (the arguments of the function) and a term (the body of the function).</p></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><table><tr id="type-t.pvar" class="anchored"><td class="def record field"><a href="#type-t.pvar" class="anchor"></a><code><span>pvar : <a href="../Term/Variable/index.html#type-t">Term.Variable.t</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The main function symbol, storing general information about the PMRS. The specification associated to the PMRS may be found using: <code>get_spec pvar</code> The type of the PMRS (the main function of the group of mutually recursive functions) is stored as the type of pvar.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.pinput_typ" class="anchored"><td class="def record field"><a href="#type-t.pinput_typ" class="anchor"></a><code><span>pinput_typ : <span><a href="../RType/index.html#type-t">RType.t</a> <span class="xref-unresolved">Base</span>.list</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The input type(s). For now, it should be a singleton list. The input type is only the type of the recursively-typed argument of the PMRS, not the parameters.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.poutput_typ" class="anchored"><td class="def record field"><a href="#type-t.poutput_typ" class="anchor"></a><code><span>poutput_typ : <a href="../RType/index.html#type-t">RType.t</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Output type and optional invariant on output of function.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.pargs" class="anchored"><td class="def record field"><a href="#type-t.pargs" class="anchor"></a><code><span>pargs : <span><a href="../Term/Variable/index.html#type-t">Term.Variable.t</a> <span class="xref-unresolved">Base</span>.list</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Parameter arguments.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.psyntobjs" class="anchored"><td class="def record field"><a href="#type-t.psyntobjs" class="anchor"></a><code><span>psyntobjs : <a href="../Variables/VarSet/index.html#type-t">Variables.VarSet.t</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The unknowns to synthesize.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.prules" class="anchored"><td class="def record field"><a href="#type-t.prules" class="anchor"></a><code><span>prules : <span><a href="#type-rewrite_rule">rewrite_rule</a> <a href="../../Utils/IntMap/index.html#type-t">Utils.IntMap.t</a></span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The rules of the PMRS.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.pnon_terminals" class="anchored"><td class="def record field"><a href="#type-t.pnon_terminals" class="anchor"></a><code><span>pnon_terminals : <a href="../Term/VarSet/index.html#type-t">Term.VarSet.t</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Non-terminals of the PMRS.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.pmain_symb" class="anchored"><td class="def record field"><a href="#type-t.pmain_symb" class="anchor"></a><code><span>pmain_symb : <a href="../Term/index.html#type-variable">Term.variable</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The main symbol of the PMRS.</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.porder" class="anchored"><td class="def record field"><a href="#type-t.porder" class="anchor"></a><code><span>porder : <span class="xref-unresolved">Base</span>.int;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The order of the PMRS (mostly useless for now).</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.plogic" class="anchored"><td class="def record field"><a href="#type-t.plogic" class="anchor"></a><code><span>plogic : <a href="../SmtLogic/index.html#type-logic_info">SmtLogic.logic_info</a>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>The main PMRS type.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Functions" class="anchored"><a href="#module-Functions" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Functions/index.html">Functions</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Context for:</p></div></div><div class="odoc-spec"><div class="spec value" id="val-update_order" class="anchored"><a href="#val-update_order" class="anchor"></a><code><span><span class="keyword">val</span> update_order : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Update the order of a PMRS.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_logic_info_of_pmrs" class="anchored"><a href="#val-set_logic_info_of_pmrs" class="anchor"></a><code><span><span class="keyword">val</span> set_logic_info_of_pmrs : <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Set the logic info field of a PMRS.</p></div></div><p>1 Utility functions, transformation, conversion to functions.</p><p>}</p><div class="odoc-spec"><div class="spec value" id="val-func_to_pmrs" class="anchored"><a href="#val-func_to_pmrs" class="anchor"></a><code><span><span class="keyword">val</span> func_to_pmrs : 
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Term/Variable/index.html#type-t">Term.Variable.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Term/index.html#type-fpattern">Term.fpattern</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Term/index.html#type-term">Term.term</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Translate a recursive function to a PMRS (currently only work for identity).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-func_of_pmrs" class="anchored"><a href="#val-func_of_pmrs" class="anchor"></a><code><span><span class="keyword">val</span> func_of_pmrs : <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Term/index.html#type-function_descr">Term.function_descr</a> <span class="xref-unresolved">Base</span>.list</span></span></code></div><div class="spec-doc"><p>Translate a PMRS to a set of (mutually) recursive functions.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-inverted_rule_lookup" class="anchored"><a href="#val-inverted_rule_lookup" class="anchor"></a><code><span><span class="keyword">val</span> inverted_rule_lookup : 
  <span>?boundvars:<span><span>( <a href="../Term/Variable/index.html#type-t">Term.Variable.t</a>, <a href="../Term/Variable/index.html#type-comparator_witness">Term.Variable.comparator_witness</a> )</span> <span class="xref-unresolved">Base</span>.Set.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>( <span class="type-var">'a</span>,
    <a href="../Term/Variable/index.html#type-t">Term.Variable.t</a>
    * <span><a href="../Term/Variable/index.html#type-t">Term.Variable.t</a> <span class="xref-unresolved">Base</span>.list</span>
    * <span><a href="../Term/index.html#type-pattern">Term.pattern</a> <span class="xref-unresolved">Base</span>.option</span>
    * <a href="../Term/index.html#type-term">Term.term</a>,
    <span class="type-var">'b</span> )</span>
    <span class="xref-unresolved">Base</span>.Map.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Term/index.html#type-term">Term.term</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Term/index.html#type-term">Term.term</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span class="type-var">'a</span>, <a href="../Term/index.html#type-term">Term.term</a>, <span class="type-var">'b</span> )</span> <span class="xref-unresolved">Base</span>.Map.t</span></span></code></div><div class="spec-doc"><p>inverted_rule_lookup searches for rules whose rhs match (func args), and return a map from rule id to the lhs of the rules matching (func args), with the appropriate substitutions performed.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-subst_rule_rhs" class="anchored"><a href="#val-subst_rule_rhs" class="anchor"></a><code><span><span class="keyword">val</span> subst_rule_rhs : 
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>p:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="../Term/index.html#type-term">Term.term</a> * <a href="../Term/index.html#type-term">Term.term</a>)</span> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Apply a substitution to all the right hand side of the PMRS rules.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-depends" class="anchored"><a href="#val-depends" class="anchor"></a><code><span><span class="keyword">val</span> depends : <span>glob:<a href="Functions/index.html#type-ctx">Functions.ctx</a> <span class="arrow">&#45;&gt;</span></span> <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="xref-unresolved">Base</span>.list</span></span></code></div><div class="spec-doc"><p>Given an input PMRS, returns a list of PMRS that this PMRS depends on.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lhs" class="anchored"><a href="#val-lhs" class="anchor"></a><code><span><span class="keyword">val</span> lhs : 
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Term/index.html#type-variable">Term.variable</a>
   * <span><a href="../Term/index.html#type-variable">Term.variable</a> <span class="xref-unresolved">Base</span>.list</span>
   * <span><a href="../Term/index.html#type-pattern">Term.pattern</a> <span class="xref-unresolved">Base</span>.option</span>
   * <a href="../Term/index.html#type-term">Term.term</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../Term/index.html#type-term">Term.term</a></span></code></div><div class="spec-doc"><p>Generate the term that corresponds to the left hand side of a rewrite rule in a PMRS.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-update_output_type" class="anchored"><a href="#val-update_output_type" class="anchor"></a><code><span><span class="keyword">val</span> update_output_type : <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Updates and returns the output type of a PMRS.</p></div></div><p>1 PMRS and Types</p><p>}</p><div class="odoc-spec"><div class="spec value" id="val-clear_pmrs_types" class="anchored"><a href="#val-clear_pmrs_types" class="anchor"></a><code><span><span class="keyword">val</span> clear_pmrs_types : <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Clear the type information inside a PMRS.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-infer_pmrs_types" class="anchored"><a href="#val-infer_pmrs_types" class="anchor"></a><code><span><span class="keyword">val</span> infer_pmrs_types : <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Infer the types inside a PMRS.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-unify_two_with_vartype_update" class="anchored"><a href="#val-unify_two_with_vartype_update" class="anchor"></a><code><span><span class="keyword">val</span> unify_two_with_vartype_update : 
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../RType/index.html#type-t">RType.t</a> * <a href="../RType/index.html#type-t">RType.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../RType/index.html#type-t">RType.t</a> * <a href="../RType/index.html#type-t">RType.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="../RType/index.html#type-substitution">RType.substitution</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-unify_one_with_update" class="anchored"><a href="#val-unify_one_with_update" class="anchor"></a><code><span><span class="keyword">val</span> unify_one_with_update : 
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../RType/index.html#type-t">RType.t</a> * <a href="../RType/index.html#type-t">RType.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-extract_rec_input_typ" class="anchored"><a href="#val-extract_rec_input_typ" class="anchor"></a><code><span><span class="keyword">val</span> extract_rec_input_typ : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../RType/index.html#type-t">RType.t</a></span></code></div></div><p>1 Pretty printing functions.</p><p>}</p><div class="odoc-spec"><div class="spec value" id="val-pp_rewrite_rule" class="anchored"><a href="#val-pp_rewrite_rule" class="anchor"></a><code><span><span class="keyword">val</span> pp_rewrite_rule : 
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Base</span>.Formatter.t <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-rewrite_rule">rewrite_rule</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.unit</span></code></div><div class="spec-doc"><p>Pretty print a rewrite rule, as in a PMRS.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : 
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Base</span>.Formatter.t <span class="arrow">&#45;&gt;</span></span>
  <span>?short:<span class="xref-unresolved">Base</span>.bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.unit</span></code></div><div class="spec-doc"><p>Pretty print a PMRS.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_ocaml" class="anchored"><a href="#val-pp_ocaml" class="anchor"></a><code><span><span class="keyword">val</span> pp_ocaml : 
  <span>ctx:<a href="../Term/Context/index.html#type-t">Term.Context.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Base</span>.Formatter.t <span class="arrow">&#45;&gt;</span></span>
  <span>?short:<span class="xref-unresolved">Base</span>.bool <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Base</span>.unit</span></code></div><div class="spec-doc"><p>Pretty print a PMRS using Ocaml syntax (as a set of recursive functions).</p></div></div></div></body></html>